Set objFSO = CreateObject("Scripting.FileSystemObject")
Set stdout = objFSO.GetStandardStream (1) 'stdout.WriteLine "standard output."
Set stderr = objFSO.GetStandardStream (2) 'stderr.WriteLine "error output."

objStartFolder = "D:\test\WEKA_KNOWLEDGE_FLOW\outputs"
Set objFolder = objFSO.GetFolder(objStartFolder)

stdout.WriteLine("")
ShowSubfolders objFSO.GetFolder(objStartFolder)
stdout.WriteLine("")
stdout.WriteLine("")


Sub ShowSubFolders(Folder)
	insertered = 0
	For Each objFile in objFolder.Files
		'stdout.WriteLine(objFolder.path + "\"+ objFile.Name + " xxxxxxxxxxxxxxxx " + XXXXX)
		filepath=objFolder.path + "\"+ objFile.Name
		Set objInputFile = objFSO.OpenTextFile(filepath)
		Do until objInputFile.AtEndOfStream
			tmpStr = objInputFile.ReadLine
			
			
			'if instr(tmpStr,"Classified Instances")>0 then
			'	stdout.WriteLine (objFile.Name + Chr(9) +  tmpStr)
			'end if
			
			file_name = objFile.Name 
			file_name = Replace(file_name,"weka_ngram_","N")
			file_name = Replace(file_name,".txt","")
			file_name_len = len(file_name)
			for num =file_name_len to 50
				file_name = file_name + "."
			next

			header ="Weighted Avg."
			header_len = len(header)
			for num =header_len to 50
				header = header + "."
			next

			'format the data
			tmpStr = Replace(tmpStr,"                 ", "")
			
			if instr(tmpStr,"TP Rate  FP Rate  Precision  Recall   F-Measure  MCC      ROC Area  PRC Area  Class")>0 and insertered<1 then
				insertered =1
				stdout.WriteLine (header + Chr(9) +  tmpStr)
			end if
			
			if instr(tmpStr,"Weighted Avg.")>0 then
				tmpStr = Replace(tmpStr,"Weighted Avg.    ", "")
				stdout.WriteLine (file_name + Chr(9) +  tmpStr)
			end if
			
		loop
	Next
End Sub

