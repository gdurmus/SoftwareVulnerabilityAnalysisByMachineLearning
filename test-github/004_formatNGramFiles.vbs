Const ForReading = 1    
Const ForWriting = 2

strFileName = Wscript.Arguments(0)
ngramValue = Wscript.Arguments(1)

'strOldText = Wscript.Arguments(1)
'strNewText = Wscript.Arguments(2)

Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objFile = objFSO.OpenTextFile(strFileName, ForReading)
strText = objFile.ReadAll
objFile.Close

strNewText = strText
strNewText = Replace(strNewText,"0", "")  
strNewText = Replace(strNewText,"1", "") 
strNewText = Replace(strNewText,"2", "") 
strNewText = Replace(strNewText,"3", "") 
strNewText = Replace(strNewText,"4", "") 
strNewText = Replace(strNewText,"5", "") 
strNewText = Replace(strNewText,"6", "") 
strNewText = Replace(strNewText,"7", "")  
strNewText = Replace(strNewText,"8", "") 
strNewText = Replace(strNewText,"9", "") 
strNewText = Replace(strNewText," ", "_")

'SAVE N-GRAMS TO ANALYSE DIFF BETWEEN SECURE & VULNERABLE VERSION...
ngramFile = strFileName +"_"+ngramValue+ ".ngrams"
ngramFileDir = "D:\\test\\test-data\\N-GRAMS-ALL\\"
Set objFile = objFSO.CreateTextFile(ngramFile, TRUE)
objFile.Write strNewText
objFile.Close
CreateFullPath ngramFileDir
objFSO.CopyFile ngramFile, ngramFileDir
objFSO.DeleteFile  ngramFile

strNewText = Replace(strNewText, vbCrLf, " ")
strNewText = Replace(strNewText, vbCr, " ")
strNewText = Replace(strNewText, vbLf, " ")
strNewText = Replace(strNewText, "_ ", " ")

'Ready to import weka arff file...
Set objFile = objFSO.CreateTextFile(strFileName, TRUE)
objFile.Write strNewText
objFile.Close


Sub CreateFullPath(ByVal FullPath)
	If Not objFSO.FolderExists(FullPath) Then
		CreateFullPath objFSO.GetParentFolderName(FullPath)
		objFSO.CreateFolder FullPath
	End If
End Sub