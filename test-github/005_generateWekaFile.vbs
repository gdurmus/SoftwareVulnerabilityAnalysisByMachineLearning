Const ForReading = 1    
Const ForWriting = 2

Set objFSO = CreateObject("Scripting.FileSystemObject")
Set stdout = objFSO.GetStandardStream (1) 'stdout.WriteLine "standard output."
Set stderr = objFSO.GetStandardStream (2) 'stderr.WriteLine "error output."

ngramValue = Wscript.Arguments(0)

printHeader

objStartFolder = "D:\test\test-data\N-GRAMS-"+ngramValue

processSubFolders objFSO.GetFolder(objStartFolder)

Sub processSubFolders(Folder)
    For Each Subfolder in Folder.SubFolders
        Set objFolder = objFSO.GetFolder(Subfolder.Path)
        Set colFiles = objFolder.Files
        For Each objFile in colFiles
			stdout.Write("'" + objFile +"','")
			
			set data = objFSO.OpenTextFile(objFile, ForReading)
			strText = data.ReadAll
			data.Close
			stdout.Write(strText)
			
			stdout.Write("',")
			if(instr(objFile, "VULNERABLE") > 0) then
				stdout.Write("Vulnerable")
			elseif (instr(objFile, "SECURE") > 0) then
				stdout.Write("Secure")
			else	
				stdout.Write("Unknown")
			end if
			stdout.WriteLine("")
        Next
    Next
End Sub



sub printHeader()
	stdout.WriteLine("% ################################################################")
	stdout.WriteLine("% Gebze Technical University")
	stdout.WriteLine("% Network and Information Security Laboratory")
	stdout.WriteLine("% Gursoy DURMUS / gdurmus@yahoo.com")
	stdout.WriteLine("% Generation Date: " + DateInfo & Now)
	stdout.WriteLine("% ################################################################")
	stdout.WriteLine("")
	stdout.WriteLine("@relation SW_SEC_DATA_STRUCTURE")
	stdout.WriteLine("@attribute FILE string")
	stdout.WriteLine("@attribute NGRAM"+ngramValue+" string")
	stdout.WriteLine("@attribute CLASS {Vulnerable,Secure}")
	stdout.WriteLine("")
	stdout.WriteLine("@data")
	stdout.WriteLine("")
	stdout.WriteLine("")
end sub