Set objFSO = CreateObject("Scripting.FileSystemObject")
Set stdout = objFSO.GetStandardStream (1) 'stdout.WriteLine "standard output."
Set stderr = objFSO.GetStandardStream (2) 'stderr.WriteLine "error output."

ngramValue = Wscript.Arguments(0)

objStartFolder = "D:\test\test-data\OPCODE_FILES"
Set objFolder = objFSO.GetFolder(objStartFolder)

stdout.WriteLine("")
ShowSubfolders objFSO.GetFolder(objStartFolder)
stdout.WriteLine("")
stdout.WriteLine("")
 
stdout.WriteLine("set START_TIME=%TIME%")
stdout.WriteLine("set /A START_TIME_VALUE=(1%START_TIME:~0,2%-100)*3600000 + (1%START_TIME:~3,2%-100)*60000 + (1%START_TIME:~6,2%-100)*1000 + (1%START_TIME:~9,2%-100)*10")
stdout.WriteLine("REM ----------------------------------------------------------------------------------")
stdout.WriteLine("REM ----------------------------------------------------------------------------------")
stdout.WriteLine("REM 6-Generate WEKA file...")
stdout.WriteLine("CSCRIPT /nologo 005_generateWekaFile.vbs " +chr(34)+ngramValue+chr(34) +" > " +chr(34) +"D:\test\test-data\WEKA_FILES\weka_ngram_" + ngramValue + ".arff" + chr(34) )
stdout.WriteLine("REM ----------------------------------------------------------------------------------")
stdout.WriteLine("REM ----------------------------------------------------------------------------------")
stdout.WriteLine("set END_TIME=%TIME%")
stdout.WriteLine("set /A END_TIME_VALUE=(1%END_TIME:~0,2%-100)*3600000 + (1%END_TIME:~3,2%-100)*60000 + (1%END_TIME:~6,2%-100)*1000 + (1%END_TIME:~9,2%-100)*10")
stdout.WriteLine("set /A DIFF=(%END_TIME_VALUE% - %START_TIME_VALUE%)")
stdout.WriteLine("echo "+ngramValue+" %START_TIME% %END_TIME% %DIFF% WEKA_FILE_GENERATED >> test-data\performance_measuring.log")



Sub ShowSubFolders(Folder)
    For Each Subfolder in Folder.SubFolders
        Set objFolder = objFSO.GetFolder(Subfolder.Path)
        Set colFiles = objFolder.Files
        For Each objFile in colFiles
            'stdout.WriteLine(objFolder.path + "\"+ objFile.Name)
			nGramFolder = Replace(objFolder,"OPCODE_FILES", "N-GRAMS-"+ngramValue)
			CreateFullPath nGramFolder
			opcodeFile= chr(34)+ objFolder.path + "\"+ objFile.Name + chr(34)
			ngramFile = chr(34) + nGramFolder+ "\"+ objFile.Name +chr(34)
			stdout.WriteLine("CSCRIPT /nologo 004_formatNGramFiles.vbs " + ngramFile +" " + chr(34)+ngramValue +chr(34))
        Next
		
        ShowSubFolders Subfolder
    Next
End Sub

Sub CreateFullPath(ByVal FullPath)
	If Not objFSO.FolderExists(FullPath) Then
		CreateFullPath objFSO.GetParentFolderName(FullPath)
		objFSO.CreateFolder FullPath
	End If
End Sub