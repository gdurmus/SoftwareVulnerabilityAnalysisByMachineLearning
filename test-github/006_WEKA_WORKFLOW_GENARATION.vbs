Set objFSO = CreateObject("Scripting.FileSystemObject")
Set stdout = objFSO.GetStandardStream (1) 'stdout.WriteLine "standard output."
Set stderr = objFSO.GetStandardStream (2) 'stderr.WriteLine "error output."

'OpenTextFile Method needs a Const value ForAppending = 8 ForReading = 1, ForWriting = 2
Const ForAppending = 8

template_file0 = "D:\test\WEKA_KNOWLEDGE_FLOW\WEKA_WORKFLOW_GENERATION\N__ (6)__TEMPLATE.kf"
template_file1 = "D:\test\WEKA_KNOWLEDGE_FLOW\WEKA_WORKFLOW_GENERATION\N__ (6)__TEMPLATE_PART-I.kf"
template_file2 = "D:\test\WEKA_KNOWLEDGE_FLOW\WEKA_WORKFLOW_GENERATION\N__ (6)__TEMPLATE_PART-II.kf"

for nGram=1 to 35
	generate_weka_file template_file0, nGram, "_ALL"
	'generate_weka_file template_file1, nGram, "_PART-1"
	'generate_weka_file template_file2, nGram, "_PART-2"
next

for nGram=40 to 125 step 5
	generate_weka_file template_file0, nGram, "_ALL"
	'generate_weka_file template_file1, nGram, "_PART-1"
	'generate_weka_file template_file2, nGram, "_PART-2"
next

for nGram=150 to 200 step 25
	generate_weka_file template_file0, nGram, "_ALL"
	'generate_weka_file template_file1, nGram, "_PART-1"
	'generate_weka_file template_file2, nGram, "_PART-2"
next

Sub generate_weka_file(template_file, nGram, postFix)
		Set objInputFile  = objFSO.OpenTextFile(template_file)

		objOutputFileName = "D:\test\WEKA_KNOWLEDGE_FLOW\WEKA_WORKFLOW_GENERATION\N__ ("&nGram&")"&postFix&".kf"
		Set objOutputFile = objFSO.OpenTextFile(objOutputFileName, ForAppending, True)

		Do until objInputFile.AtEndOfStream
			tmpStr = objInputFile.ReadLine
			find_str = "weka_ngram_6"
			replace_str = "weka_ngram_" & nGram
			tmpStr = Replace (tmpStr,find_str, replace_str)

			find_str = "N__ (6)__TEMPLATE"
			replace_str = "N__ ("& nGram &")" & postFix
			tmpStr = Replace (tmpStr,find_str, replace_str)

			find_str = "N__ (6)__TEMPLATE_PART-I"
			replace_str = "N__ ("& nGram &")" & postFix
			tmpStr = Replace (tmpStr,find_str, replace_str)

			find_str = "N__ (6)__TEMPLATE_PART-II"
			replace_str = "N__ ("& nGram &")" & postFix
			tmpStr = Replace (tmpStr,find_str, replace_str)
			
			objOutputFile.WriteLine(tmpStr)
		loop
		objOutputFile.Close		
		stdout.WriteLine (objOutputFileName & " generated...")
End Sub


